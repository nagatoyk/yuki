/* <i.mouto.org> 音乐<虾米>部分 @卜卜口 */
var xiami=function(g,f){$.lcss('//i.mouto.org/f/xiami.m.css');if(!$.Audio){$.Audio=new Audio()}$.Audio.addEventListener('ended',function(){if($('.xiami.play')){$('.xiami.play').className='xiami'}a=''},false);var a='',b=function(o){for(var n=parseInt(o),l=o.substr(1),k=Math.floor(l.length/n),h=l.length%n,p=new Array(),m=0;m<h;m++){p[m]=l.substr((k+1)*m,k+1)}for(m=h;m<n;m++){p[m]=l.substr(k*(m-h)+(k+1)*h,k)}for(m=0,k=l='';m<p[0].length;m++){for(j=0;j<p.length;j++){k+=p[j].substr(m,1)}}for(m=0,k=unescape(k);m<k.length;m++){k.substr(m, 1)=='^'?l+='0':l+=k.substr(m,1)}return l},e={},c=function(){for(var p=$.S('.xiami'),k,n,o,h=p.length,m=0;m<h;m++){k=p[m];o=k.href.match(/[0-9]{5,12}$/)*1;if(!o||!(n=e[o])){continue}if(k.onclick){continue}if(a==o){k.className='xiami play'}k.innerHTML=(n.title.match(/^「.*」$/)?n.title:'「'+n.title+'」')+n.artist;k.onclick=function(){var l=e[this.href.match(/[0-9]{5,12}$/)];var q=l.song_id;if(this.className=='xiami'){var i;if(i=$('.xiami.play,.xiami.pause')){i.className='xiami'}a=q;this.className='xiami play';$.Audio.src=b(l.mp3);$.Audio.play()}else{if(this.className=='xiami play'){this.className='xiami pause';$.Audio.pause()}else{this.className='xiami play';$.Audio.play()}}return false}}},d={load:function(){for(var o=$.S('.xiami'),h=o.length,k=0,m=[];k<h;k++){var n=o[k].href.match(/[0-9]{5,12}$/);if(n&&!e[n]){m.push(n)}}c();if(m.length>0){$.j('http://itorr.sinaapp.com/fm/x/?a=song&cb={cb}&id='+m.join(','),function(r){if(r.error){return alert('出错了！'+r.error)}if(!r.length){return}var p,q;for(p=r.length,q=0;q<p;q++){e[r[q].xid]=r[q]}c()})}},D:e};d.load();return d}(window,document);
/* 音乐 End */