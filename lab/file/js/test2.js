var haveimage = ['K.png', 'KAbukuma.jpg', 'KAbukumaKai.jpg', 'KAganoKai.jpg', 'KAkagi.png', 'KAkagiKai.png', 'KAkashi.jpg', 'KAkashiKai.jpg', 'KAkatsuki.jpg', 'KAkatsukiKai.png', 'KAkatsukiKai2.jpg', 'KAkebono.jpg', 'KAkebonoKai.png', 'KAkigumo.jpg', 'KAkitsuMaru.jpg', 'KAkitsuMaruKai.jpg', 'KAkitsushima.jpg', 'KAkitsushimaKai.jpg', 'KAkizukiKai.jpg', 'KAmagiKai.jpg', 'KAmatsukaze.jpg', 'KAmatsukazeKai.jpg', 'KAoba.jpg', 'KAobaKai.png', 'KArare.png', 'KArashio.jpg', 'KAsagumoKai.jpg', 'KAsashimoKai.jpg', 'KAsashio.jpg', 'KAshigara.jpg', 'KAshigaraKai.png', 'KAshigaraKai2.jpg', 'KAtago.jpg', 'KAtagoKai.png', 'KAyanami.jpg', 'KAyanamiKai.png', 'KAyanamiKai2.jpg', 'KBismarck.jpg', 'KBismarckdrei.jpg', 'KBismarckKai.jpg', 'KChi.jpg', 'KChiE.png', 'KChiF.png', 'KChikuma.jpg', 'KChikumaKai2.jpg', 'KChitose.jpg', 'KChitoseA.jpg', 'KChitoseCVLKai2.jpg', 'KChiyoda.jpg', 'KChiyodaA.jpg', 'KChiyodaCVLKai2.jpg', 'KChoukai.jpg', 'KChoukaiKai.png', 'KChoukaiKai2.jpg', 'KFubuki.jpg', 'KFubukiKai.png', 'KFubukiKai2.jpg', 'KFumizuki.png', 'KFumizukiKai.png', 'KFurutaka.jpg', 'KFurutakaKai2.jpg', 'KFusou.jpg', 'KFusouKai.jpg', 'KFusouKai2.jpg', 'KHa.jpg', 'KHaE.png', 'KHaguro.png', 'KHaguroKai.png', 'KHaguroKai2.jpg', 'KHamakaze.jpg', 'KHaruna.jpg', 'KHarunaKai.png', 'KHarunaKai2.jpg', 'KHarusameKai.jpg', 'KHatsuharu.jpg', 'KHatsuharuKai.png', 'KHatsushimo.png', 'KHatsushimoKai.png', 'KHatsushimoKai2.jpg', 'KHatsuyuki.jpg', 'KHatsuyukiKai.png', 'KHe.jpg', 'KHeE.jpg', 'KHeF.jpg', 'KHibiki.png', 'KHibikiKai.png', 'KHiei.jpg', 'KHieiKai.png', 'KHieiKai2.jpg', 'KHiryuu.png', 'KHiryuuKai.jpg', 'KHiryuuKai2.jpg', 'KHiyou.jpg', 'KHiyouKai.jpg', 'KHo.jpg', 'KHoE.jpg', 'KHoF.jpg', 'KHoushou.jpg', 'KHoushouKai.png', 'KHyuuga.jpg', 'KHyuugaKai.jpg', 'KI-168.jpg', 'KI-168Kai.jpg', 'KI-19.jpg', 'KI-19Kai.jpg', 'KI-401.jpg', 'KI-401Kai.jpg', 'KI-58.jpg', 'KI-58Kai.jpg', 'KI-8.jpg', 'KI-8Kai.jpg', 'KI.jpg', 'KIE.png', 'KIkazuchi.jpg', 'KIkazuchiKai.png', 'KInazuma.png', 'KInazumaKai.png', 'KIse.jpg', 'KIseKai.jpg', 'KIsonami.png', 'KIsonamiKai.png', 'KIsuzu.jpg', 'KIsuzuKai.jpg', 'KIsuzuKai2.jpg', 'KItalia.jpg', 'KJintsuu.jpg', 'KJintsuuKai.jpg', 'KJintsuuKai2.jpg', 'KJunyou.png', 'KJunyouKai.jpg', 'KJunyouKai2.jpg', 'KKa.jpg', 'KKaE.jpg', 'KKaga.jpg', 'KKagaKai.png', 'KKako.jpg', 'KKakoKai.png', 'KKakoKai2.jpg', 'KKasumi.jpg', 'KKatoriKai.jpg', 'KKatsuragi.jpg', 'KKatsuragiKai.jpg', 'KKikuzuki.png', 'KKikuzukiKai.png', 'KKinu.jpg', 'KKinugasa.jpg', 'KKinugasaKai.jpg', 'KKinugasaKai2.jpg', 'KKinuKai.jpg', 'KKirishima.jpg', 'KKirishimaKai.png', 'KKirishimaKai2.jpg', 'KKisaragi.png', 'KKisaragiKai.png', 'KKiso.png', 'KKisoKai.jpg', 'KKisoKai2.jpg', 'KKitakami.jpg', 'KKitakamiKai.png', 'KKitakamiKai2.jpg', 'KKiyoshimo.jpg', 'KKiyoshimoKai.jpg', 'KKongou.png', 'KKongouKai.png', 'KKongouKai2.jpg', 'KKuma.jpg', 'KKumaKai.jpg', 'KKumano.jpg', 'KKumanoKai.jpg', 'KKuroshio.jpg', 'KKuroshioKai.jpg', 'KLittorio.jpg', 'KMaikazeKai.jpg', 'KMakigumo.jpg', 'KMaruyu.jpg', 'KMaruyuKai.jpg', 'KMaya.jpg', 'KMayaKai.png', 'KMayaKai2.jpg', 'KMichishio.jpg', 'KMikazuki.png', 'KMikazukiKai.png', 'KMikuma.jpg', 'KMikumaKai.jpg', 'KMiyuki.jpg', 'KMochizuki.png', 'KMochizukiKai.png', 'KMogami.jpg', 'KMogamiKai.png', 'KMurakumo.jpg', 'KMurakumoKai.png', 'KMurakumoKai2.jpg', 'KMurasame.jpg', 'KMurasameKai.jpg', 'KMusashiKai.jpg', 'KMutsu.png', 'KMutsuKai.png', 'KMutsuki.png', 'KMutsukiKai.png', 'KMyoukou.jpg', 'KMyoukouKai.png', 'KMyoukouKai2.jpg', 'KNachi.jpg', 'KNachiKai.png', 'KNachiKai2.jpg', 'KNaganami.jpg', 'KNagara.png', 'KNagaraKai.jpg', 'KNagato.png', 'KNagatoKai.png', 'KNagatsuki.png', 'KNagatsukiKai.png', 'KNaka.png', 'KNakaKai2.jpg', 'KNatori.png', 'KNatoriKai.jpg', 'KNenohi.png', 'KNi.jpg', 'KNiE.png', 'KNoshiro.jpg', 'KNoshiroKai.jpg', 'KNowaki.jpg', 'KNu.jpg', 'KNuE.jpg', 'KOboro.jpg', 'KOoiKai.png', 'KOoiKai2.jpg', 'KOoshio.jpg', 'KOoshioKai.png', 'KOoyodoKai.jpg', 'KPrinzEugenKai.jpg', 'KRi.png', 'KRiE.png', 'KRiF.png', 'KRo-500.jpg', 'KRo.jpg', 'KRoE.png', 'KRoF.jpg', 'KRoma.jpg', 'KRomaKai.jpg', 'KRu.png', 'KRuE.png', 'KRuF.png', 'KRyuujou.jpg', 'KRyuujouKai.jpg', 'KSakawa.jpg', 'KSakawaKai.jpg', 'KSamidare.jpg', 'KSatsuki.jpg', 'KSatsukiKai.png', 'KSazanami.jpg', 'KSazanamiKai.png', 'KSendai.png', 'KSendaiKai2.jpg', 'KShigure.jpg', 'KShigureKai2.jpg', 'KShikinami.jpg', 'KShimakaze.png', 'KShimakazeKai.png', 'KShiranui.jpg', 'KShiranuiKai.jpg', 'KShiratsuyu.jpg', 'KShirayuki.png', 'KShouhou.jpg', 'KShouhouKai.png', 'KShoukaku.jpg', 'KShoukakuKai.jpg', 'KSouryuu.jpg', 'KSouryuuKai.png', 'KSouryuuKai2.jpg', 'KSuzukaze.jpg', 'KSuzuya.jpg', 'KSuzuyaKai.jpg', 'KTaE.jpg', 'KTaF.jpg', 'KTaigei.jpg', 'KTaihouKai.jpg', 'KTakanami.jpg', 'KTakanamiKai.jpg', 'KTakao.jpg', 'KTakaoKai.png', 'KTama.jpg', 'KTamaKai.jpg', 'KTatsuta.jpg', 'KTenryuu.jpg', 'KTenryuuKai.jpg', 'KTo.jpg', 'KToE.jpg', 'KTokitsukazeKai.jpg', 'KTone.jpg', 'KToneKai.png', 'KToneKai2.jpg', 'KU-511Kai.jpg', 'KUnryuu.jpg', 'KUnryuuKai.jpg', 'KUshio.jpg', 'KUshioKai.png', 'KUshioKai2.jpg', 'KUzuki.jpg', 'KUzukiKai.jpg', 'KVerniy.jpg', 'KWa.jpg', 'KWaE.png', 'KWakaba.jpg', 'KWakabaKai.png', 'KWo.png', 'KWoE.png', 'KYahagi.jpg', 'KYamashiro.jpg', 'KYamashiroKai.jpg', 'KYamashiroKai2.jpg', 'KYamato.jpg', 'KYamatoKai.jpg', 'KYayoi.jpg', 'KYayoiKai.jpg', 'KYo.jpg', 'KYoE.jpg', 'KYukikaze.png', 'KYukikazeKai.png', 'KYura.jpg', 'KYuraKai.jpg', 'KYuubari.jpg', 'KYuubariKai.jpg', 'KYuudachi.jpg', 'KYuudachiKai.png', 'KYuudachiKai2.jpg', 'KYuugumoKai.jpg', 'KZ1.jpg', 'KZ3.jpg', 'KZuihou.jpg', 'KZuihouKai.jpg', 'KZuikaku.jpg', 'KZuikakuKai.jpg', 'KWoF.jpg', 'KHaF.png', 'KKaF.png', 'KBBH.jpg','KHarbourH2.jpg'];

var code = '';//'1,1,1~Nenohi,30|HatsushimoKai2,31|WakabaKai,30|HatsuharuKai,30|KagaKai,79|AkagiKai,77~RuF,98|RuE,90|HoF,53|ChiE,50|NiE,45|NiE,45~A:4,12,0|4,14,0|4,11,12|5,10,24|5,15,136|5,14,0|5,14,0~T:~S:2,13,1,0|10,4,1,0|1,12,1,21|11,3,1,0|0,12,1,0|13,2,1,0|3,13,1,30|12,3,1,15|4,12,4,110|14,4,1,0|5,14,4,0~S:0,10,1,10|10,2,1,0|1,14,1,75|11,5,1,0|2,10,1,5|13,3,1,8|3,11,1,8|4,11,4,85|5,10,4,0~T:0,10,5|1,10,10|2,10,4~N:0,10,2,4,2|10,4,2,47,2|1,13,2,131,119|2,10,2,85,84~'
var API = {};
var APIsample = '{"diff":0,"world":3,"mapnum":5,"fleetnum":1,"combined":0,"fleet1":[{"mst_id":290,"level":75,"kyouka":[39,55,44,30,0],"morale":85,"equip":[90,90,102,0]},{"mst_id":195,"level":71,"kyouka":[53,57,36,39,0],"morale":68,"equip":[3,3,88,0]},{"mst_id":144,"level":72,"kyouka":[56,56,43,38,0],"morale":68,"equip":[3,3,34,0]},{"mst_id":145,"level":80,"kyouka":[44,56,48,38,0],"morale":68,"equip":[3,3,15,0]},{"mst_id":228,"level":50,"kyouka":[47,61,43,45,0],"morale":84,"equip":[3,15,15,0]},{"mst_id":229,"level":66,"kyouka":[45,51,43,45,0],"morale":68,"equip":[3,3,88,0]}],"fleet2":[{"mst_id":122,"level":20,"kyouka":[8,21,16,9,0],"morale":49,"equip":[0,0,0,0]},{"mst_id":133,"level":18,"kyouka":[10,26,16,10,0],"morale":49,"equip":[0,0,0,0]},{"mst_id":135,"level":18,"kyouka":[10,25,11,7,0],"morale":49,"equip":[0,0,0,0]},{"mst_id":134,"level":20,"kyouka":[13,23,16,9,0],"morale":49,"equip":[0,0,0,0]}],"fleet3":[{"mst_id":21,"level":26,"kyouka":[21,19,27,12,0],"morale":49,"equip":[0,0,0,0]},{"mst_id":230,"level":30,"kyouka":[13,14,16,16,0],"morale":49,"equip":[0,0,0,0]},{"mst_id":238,"level":37,"kyouka":[22,36,18,24,0],"morale":49,"equip":[0,0,0,0]},{"mst_id":168,"level":25,"kyouka":[10,25,16,13,0],"morale":49,"equip":[0,0,0,0]}],"fleet4":[{"mst_id":434,"level":73,"kyouka":[35,51,25,31,0],"morale":49,"equip":[75,75,0,0]},{"mst_id":255,"level":46,"kyouka":[21,51,18,26,0],"morale":49,"equip":[75,75,0,0]},{"mst_id":259,"level":47,"kyouka":[25,51,22,20,0],"morale":49,"equip":[75,75,0,0]},{"mst_id":261,"level":48,"kyouka":[23,49,20,21,0],"morale":49,"equip":[75,75,0,0]},{"mst_id":308,"level":35,"kyouka":[11,34,16,11,0],"morale":49,"equip":[75,0,0,0]},{"mst_id":165,"level":26,"kyouka":[12,16,16,12,0],"morale":49,"equip":[75,0,0,0]}],"support1":0,"support2":0,"time":1447578972,"hq":"20164585","id":383,"battles":[{"sortie_id":383,"node":6,"enemyId":0,"data":{"api_dock_id":1,"api_ship_ke":[555,527,521,521,576,576],"api_ship_lv":[-1,1,1,1,1,1,1],"api_nowhps":[-1,42,32,31,31,32,36,57,76,50,50,37,37],"api_maxhps":[-1,42,32,31,31,32,36,57,76,50,50,37,37],"api_midnight_flag":1,"api_eSlot":[[506,525,542,543,-1],[505,506,515,525,-1],[506,514,514,-1,-1],[506,514,514,-1,-1],[502,545,542,-1,-1],[502,545,542,-1,-1]],"api_eKyouka":[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],"api_fParam":[[59,79,59,59],[70,87,52,54],[73,93,59,52],[57,84,72,52],[59,89,59,59],[59,99,59,59]],"api_eParam":[[48,80,30,39],[68,48,40,70],[35,72,20,34],[35,72,20,34],[38,66,32,26],[38,66,32,26]],"api_search":[1,1],"api_formation":[1,1,3],"api_stage_flag":[1,0,0],"api_kouku":{"api_plane_from":[[-1],[-1]],"api_stage1":{"api_f_count":0,"api_f_lostcount":0,"api_e_count":0,"api_e_lostcount":0,"api_disp_seiku":1,"api_touch_plane":[-1,-1]},"api_stage2":null,"api_stage3":null},"api_support_flag":0,"api_support_info":null,"api_opening_flag":0,"api_opening_atack":null,"api_hourai_flag":[1,0,0,1],"api_hougeki1":{"api_at_list":[-1,1,9,4,8,3,10,2,7,5,6],"api_at_type":[-1,0,0,0,0,0,0,0,0,0,0],"api_df_list":[-1,[12],[6],[8],[2],[8],[4],[8],[6],[11],[7]],"api_si_list":[-1,[90],[506],[3],[505],[3],[506],[3],[506],[3],[3]],"api_cl_list":[-1,[1],[0],[1],[0],[1],[0],[1],[0],[1],[1]],"api_damage":[-1,[78],[0],[26],[0],[10],[0],[42],[0],[56],[32]]},"api_hougeki2":null,"api_hougeki3":null,"api_raigeki":{"api_frai":[-1,3,4,3,3,3,4],"api_erai":[-1,0,0,5,4,0,0],"api_fdam":[-1,0,0,0,17.1,0,0],"api_edam":[-1,0,0,316.1,156,0,0],"api_fydam":[-1,56,0,77,80,103,156],"api_eydam":[-1,0,0,0,17,0,0],"api_fcl":[-1,1,0,1,1,1,2],"api_ecl":[-1,0,0,0,2,0,0]}},"yasen":{},"rating":"A","drop":0,"time":1447578972,"baseEXP":400,"hqEXP":120,"shizunde":[[],[]],"mvp":[6],"hq":"20164585","id":674},{"sortie_id":383,"node":7,"enemyId":0,"data":{"api_dock_id":1,"api_ship_ke":[560,527,522,577,575,575],"api_ship_lv":[-1,1,1,1,1,1,1],"api_nowhps":[-1,42,32,31,14,32,36,84,76,60,38,35,35],"api_maxhps":[-1,42,32,31,31,32,36,84,76,60,38,35,35],"api_midnight_flag":1,"api_eSlot":[[520,524,524,517,-1],[505,506,515,525,-1],[505,506,525,525,-1],[502,515,542,-1,-1],[502,545,542,-1,-1],[502,545,542,-1,-1]],"api_eKyouka":[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],"api_fParam":[[59,79,59,59],[70,87,52,54],[73,93,59,52],[57,84,72,52],[59,89,59,59],[59,99,59,59]],"api_eParam":[[18,0,36,70],[68,48,40,70],[58,42,30,60],[44,72,36,29],[38,60,30,22],[38,60,30,22]],"api_search":[1,1],"api_formation":[2,3,1],"api_stage_flag":[1,1,1],"api_kouku":{"api_plane_from":[[-1],[7]],"api_stage1":{"api_f_count":0,"api_f_lostcount":0,"api_e_count":88,"api_e_lostcount":2,"api_disp_seiku":4,"api_touch_plane":[-1,517]},"api_stage2":{"api_f_count":0,"api_f_lostcount":0,"api_e_count":64,"api_e_lostcount":15},"api_stage3":{"api_frai_flag":[-1,0,0,1,0,0,0],"api_erai_flag":[-1,0,0,0,0,0,0],"api_fbak_flag":[-1,0,0,1,0,0,1],"api_ebak_flag":[-1,0,0,0,0,0,0],"api_fcl_flag":[-1,0,0,0,0,0,0],"api_ecl_flag":[-1,0,0,0,0,0,0],"api_fdam":[-1,0,0,0,0,0,0],"api_edam":[-1,0,0,0,0,0,0]}},"api_support_flag":0,"api_support_info":null,"api_opening_flag":0,"api_opening_atack":null,"api_hourai_flag":[1,0,0,1],"api_hougeki1":{"api_at_list":[-1,1,8,4,9,6,12,2,10,5,11,3,7],"api_at_type":[-1,0,2,0,0,0,0,0,0,0,0,0,0],"api_df_list":[-1,[8],[4,4],[10],[2],[8],[5],[8],[2],[12],[2],[10],[5]],"api_si_list":[-1,[90],[505,506],[3],[505],[3],[502],[3],[502],[3],[502],[3],[-1]],"api_cl_list":[-1,[1],[1,1],[1],[0],[1],[0],[1],[0],[1],[2],[1],[2]],"api_damage":[-1,[10],[0,1],[15],[0.1],[3],[0],[9],[0],[24],[3],[41],[19]]},"api_hougeki2":null,"api_hougeki3":null,"api_raigeki":{"api_frai":[-1,5,5,5,0,0,6],"api_erai":[-1,0,6,6,0,6,0],"api_fdam":[-1,0,0,0,0,0,6.1],"api_edam":[-1,0,0,0,0,144.1,55],"api_fydam":[-1,43,50,51,0,0,55],"api_eydam":[-1,0,4,2,0,0,0],"api_fcl":[-1,1,1,1,0,0,1],"api_ecl":[-1,0,1,1,0,0,0]}},"yasen":{},"rating":"B","drop":0,"time":1447579055,"baseEXP":400,"hqEXP":75,"shizunde":[[],[]],"mvp":[3],"hq":"20164585","id":675},{"sortie_id":383,"node":11,"enemyId":0,"data":{"api_dock_id":1,"api_ship_ke":[591,558,558,543,578,578],"api_ship_lv":[-1,1,1,1,1,1,1],"api_nowhps":[-1,42,29,31,13,13,30,48,130,130,90,40,40],"api_maxhps":[-1,42,32,31,31,32,36,48,130,130,90,40,40],"api_midnight_flag":1,"api_eSlot":[[550,550,545,525,-1],[506,504,504,-1,-1],[506,504,504,-1,-1],[509,509,525,529,-1],[502,515,542,-1,-1],[502,515,542,-1,-1]],"api_eKyouka":[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],"api_fParam":[[59,79,59,59],[70,87,52,54],[73,93,59,52],[57,84,72,52],[59,89,59,59],[59,99,59,59]],"api_eParam":[[58,84,88,55],[55,0,40,65],[55,0,40,65],[85,0,70,96],[48,84,38,33],[48,84,38,33]],"api_search":[1,1],"api_formation":[1,1,3],"api_stage_flag":[1,0,0],"api_kouku":{"api_plane_from":[[-1],[-1]],"api_stage1":{"api_f_count":0,"api_f_lostcount":0,"api_e_count":0,"api_e_lostcount":0,"api_disp_seiku":1,"api_touch_plane":[-1,-1]},"api_stage2":null,"api_stage3":null},"api_support_flag":0,"api_support_info":null,"api_opening_flag":0,"api_opening_atack":null,"api_hourai_flag":[1,1,0,1],"api_hougeki1":{"api_at_list":[-1,1,10,2,7,4,9,3,8,5,6],"api_at_type":[-1,0,0,0,0,0,0,0,0,0,0],"api_df_list":[-1,[11],[1],[12],[4],[7],[4],[8],[5],[10],[9]],"api_si_list":[-1,[90],[509],[3],[550],[3],[506],[3],[506],[3],[3]],"api_cl_list":[-1,[1],[0],[1],[0],[1],[0],[1],[0],[1],[0]],"api_damage":[-1,[67],[0],[52],[0],[4],[0],[40],[0],[6],[0]]},"api_hougeki2":{"api_at_list":[-1,1,7,2,3,9,4,10,5,6],"api_at_type":[-1,0,0,0,0,0,0,0,0,0],"api_df_list":[-1,[8],[5],[9],[10],[3],[10],[2],[7],[10]],"api_si_list":[-1,[90],[550],[3],[3],[506],[3],[509],[3],[3]],"api_cl_list":[-1,[2],[0],[1],[1],[1],[0],[0],[1],[1]],"api_damage":[-1,[93],[0],[47],[10],[13],[0],[0],[5],[9.1]]},"api_hougeki3":null,"api_raigeki":{"api_frai":[-1,1,3,1,0,0,1],"api_erai":[-1,2,0,0,0,0,0],"api_fdam":[-1,0,14,0,0,0,0],"api_edam":[-1,276,0,47,0,0,0],"api_fydam":[-1,80,47,118,0,0,78],"api_eydam":[-1,14,0,0,0,0,0],"api_fcl":[-1,2,1,2,0,0,1],"api_ecl":[-1,2,0,0,0,0,0]}},"yasen":{"api_deck_id":"1","api_nowhps":[-1,42,15,18,13,13,30,0,0,36,65,0,0],"api_ship_ke":[591,558,558,543,578,578],"api_ship_lv":[-1,1,1,1,1,1,1],"api_maxhps":[-1,42,32,31,31,32,36,48,130,130,90,40,40],"api_eSlot":[[550,550,545,525,-1],[506,504,504,-1,-1],[506,504,504,-1,-1],[509,509,525,529,-1],[502,515,542,-1,-1],[502,515,542,-1,-1]],"api_eKyouka":[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],"api_fParam":[[59,79,59,59],[70,87,52,54],[73,93,59,52],[57,84,72,52],[59,89,59,59],[59,99,59,59]],"api_eParam":[[58,84,88,55],[55,0,40,65],[55,0,40,65],[85,0,70,96],[48,84,38,33],[48,84,38,33]],"api_touch_plane":[-1,-1],"api_flare_pos":[-1,-1],"api_hougeki":{"api_at_list":[-1,1,2],"api_df_list":[-1,[10,10],[9,9]],"api_si_list":[-1,[90,90],[3,3]],"api_cl_list":[-1,[1,1],[1,1]],"api_sp_list":[-1,1,1],"api_damage":[-1,[98,82],[75,57]]}},"rating":"S","drop":170,"time":1447579148,"baseEXP":400,"hqEXP":2300,"shizunde":[[],[]],"mvp":[1],"hq":"20164585","id":676}]}';
var started = false;
var SHIPIDSORTED = [0,80,275,81,276,77,82,87,88,20,228,83,277,84,278,90,279,197,91,280,196,50,229,9,201,426,10,202,32,203,11,204,33,205,420,12,206,13,207,195,14,208,24,57,118,25,58,119,78,209,149,86,210,150,79,211,151,85,212,152,89,285,26,286,411,27,287,412,51,213,52,214,76,281,157,1,254,434,2,255,435,28,256,29,257,6,258,30,259,7,260,31,261,99,215,100,216,101,217,146,21,218,22,219,141,53,221,23,220,54,222,158,55,223,159,56,224,160,102,104,103,105,70,73,59,262,416,60,263,417,61,264,62,265,319,63,266,192,64,267,193,65,268,194,66,269,67,270,68,271,428,69,272,427,71,273,188,72,274,189,75,283,92,284,408,93,230,15,231,94,232,16,233,407,34,234,437,35,235,147,36,236,37,237,38,238,326,39,239,40,240,41,241,419,42,242,43,243,145,44,244,45,245,144,46,246,47,247,95,248,96,249,97,250,98,251,48,252,49,253,17,225,18,226,19,227,74,282,106,107,108,291,296,109,292,297,110,288,461,466,111,112,462,467,113,289,114,290,200,115,293,116,117,120,121,190,300,122,294,123,295,142,191,401,124,129,125,130,126,398,127,399,128,400,131,136,132,301,133,302,134,303,135,304,137,305,138,306,139,307,140,314,143,148,153,156,154,343,155,403,161,166,163,402,164,308,165,309,167,320,168,317,169,313,170,312,171,172,173,178,174,310,179,175,311,180,176,177,181,316,182,187,183,321,184,185,318,186,322,404,406,331,429,332,430,405,323,409,324,410,325,413,327,414,328,415,329,421,330,422,346,424,345,425,344,431,334,436,441,446,442,447,443,347,445,450,451,348,453,349,458,350,459,351,460,352];
var SHIPCLASSSORTED = {'Battleships':[],'Carriers':[],'Light Carriers':[],'Heavy Cruisers':[],'Light Cruisers':[],'Destroyers':[],'Submarines':[],'Auxiliary':[]};
for (var i=0; i<SHIPIDSORTED.length; i++) {
	if (SHIPIDSORTED[i] < 500) {
		switch(SHIPDATA[SHIPIDSORTED[i]].type) {
			case 'BB':
			case 'BBV':
			case 'BBVT':
				SHIPCLASSSORTED['Battleships'].push(SHIPIDSORTED[i]);
				break;
			case 'CV':
			case 'CVN':
			case 'CVB':
				SHIPCLASSSORTED['Carriers'].push(SHIPIDSORTED[i]);
				break;
			case 'CVL':
				SHIPCLASSSORTED['Light Carriers'].push(SHIPIDSORTED[i]);
				break
			case 'CA':
			case 'CAV':
				SHIPCLASSSORTED['Heavy Cruisers'].push(SHIPIDSORTED[i]);
				break;
			case 'CL':
			case 'CLT':
			case 'CT':
				SHIPCLASSSORTED['Light Cruisers'].push(SHIPIDSORTED[i]);
				break;
			case 'DD':
				SHIPCLASSSORTED['Destroyers'].push(SHIPIDSORTED[i]);
				break;
			case 'SS':
			case 'SSV':
				SHIPCLASSSORTED['Submarines'].push(SHIPIDSORTED[i]);
				break;
			default:
				SHIPCLASSSORTED['Auxiliary'].push(SHIPIDSORTED[i]);
				break;
		}
	}
}
// console.log(SHIPCLASSSORTED);





function shuffle(o) {
	for(var j, x, i = o.length; i; j = Math.floor(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x);
	return o;
}

function loadFile(fleet,hide) {
	var files = document.getElementById('T'+fleet+'sfile').files;
	var reader = new FileReader();
	reader.readAsText(files[0]);
	reader.addEventListener('loadend',function() { processFile(fleet,reader); });
	// document.getElementById('fleetchoose'+hide).style.display = 'none';
}

function processFile(fleetnum,reader) {
	// if (started) return;
	var kcdata = JSON.parse(reader.result);
	// console.log(kcdata);

	// genFleetHTML('fleetspace'+fleet);

	var fleet = kcdata.fleets[0].ships;
	// var s1 = [];
	for (var i=0; i<fleet.length; i++) {
		var fid = fleet[i];
		if (fid <= 0) { clickedClear(fleetnum,i); continue; }
		var mid = kcdata.ships['x'+fid].masterId;
		var ship = kcdata.ships['x'+fid];
		var name = SHIPDATA[mid].name;
		if (!name) name = '';
		// console.log(fid+' '+mid+' '+name);
		// var ShipType = SHIPDATA[mid].type;
		// s1.push(new ShipType(mid,name,0,ship.level,ship.hp[1],ship.fp[0],ship.tp[0],ship.aa[0],ship.ar[0],ship.ev[0],ship.as[0],ship.ls[0],ship.lk[0],ship.range,ship.slots.splice(0,4)));

		var equips = [];
		for (var j=0; j<4; j++) {  //get equip mids
			console.log(ship.items[j]);
			if (ship.items[j] == -1) equips.push(0);
			else equips.push(kcdata.gears['x'+ship.items[j]].masterId);
		}
		//REMEMBER HARDCODED TABLE 1, AND SPEED 1
		tableSetShip(fleetnum,i,mid,[ship.level,ship.hp[1],ship.fp[0],ship.tp[0],ship.aa[0],ship.ar[0],ship.ev[0],ship.as[0],ship.ls[0],ship.lk[0],ship.range,SHIPDATA[mid].SPD],equips);
	}
	updateFleetCode(fleetnum);

	// var f1 = new Fleet(0);
	// f1.loadShips(s1);
	// f1.formation = LINEAHEAD;


	// for (var i=0; i<fleet.length; i++) {
		//WHAT DID I TYPE THIS FOR????
	// }
	// sim(f1,FLEET2);
	// setup();
	// started = true;
}

function hidePlayer() {
	var p = document.getElementById('movie');
	if (p.style.display == 'none') p.style.display = 'block';
	else p.style.display = 'none';
}

function genResultsHTML(data) {
	var root = $('#resultspace');

	if (!WROTESTATS) {
		if (data.nodes.length <= 1) { //single node display
			$('#resulttempsingle').show();

		} else {  //multi node display
			// $('#resulttempsingle').hide();
			var battle = data.nodes[0];
			// var multitemp = ($('<div id="resulttempmulti"></div>'));
			// root.append(multitemp);
			// multitemp.append($('<div>Number of runs: <span id="rnumruns">'+data.totalnum+'</span></div><br>'));

			// var rankdiv = $('<div style="float:left;width:250px"></div>')
			// multitemp.append(rankdiv);
			// rankdiv.append($('<span>Final Rank Rate:</span><br>'));
			// rankdiv.append($('<img src="_assets/stats/S.png"></img> <span id="rankS" style="font-weight:bold">0</span><br>'));
			// rankdiv.append($('<img src="_assets/stats/A.png"></img> <span id="rankA">0</span><br>'));
			// rankdiv.append($('<img src="_assets/stats/B.png"></img> <span id="rankB">0</span><br>'));
			// rankdiv.append($('<img src="_assets/stats/C.png"></img> <span id="rankC">0</span><br>'));
			// rankdiv.append($('<img src="_assets/stats/D.png"></img> <span id="rankD">0</span><br>'));
			// rankdiv.append($('<img src="_assets/stats/salt.png"></img> <span id="rankNone">0</span><br>'));
			// rankdiv.append($('<br>'));
			// rankdiv.append($('<span>Enemy Flagship Sunk Rate:</span><br>'));
			// rankdiv.append($('<img src="_assets/stats/flagsunk.png"></img> <span id="rsunkfs" style="font-weight:bold">0</span><br>'));
			// rankdiv.append($('<br>'));
			// var ranktab = $('<table></table>');
			// rankdiv.append(ranktab);
			// ranktab.append($('<tr><th></th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th></tr>'));
			// ranktab.append($('<tr><th><img src="_assets/stats/S.png"/></th><td>0.222</td><td>0.222</td><td>0.222</td><td>0.222</td><td>0.222</td></tr>'));
			// ranktab.append($('<tr><th><img src="_assets/stats/A.png"/></th><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>'));
			// ranktab.append($('<tr><th><img src="_assets/stats/B.png"/></th><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>'));
			// ranktab.append($('<tr><th><img src="_assets/stats/C.png"/></th><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>'));
			// ranktab.append($('<tr><th><img src="_assets/stats/D.png"/></th><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>'));
			// ranktab.append($('<tr><th><img src="_assets/stats/flagsunk.png"/></th><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>'));

			// var mvpdiv = $('<div style="float:left;width:250px">');
			// multitemp.append(mvpdiv);
			// mvpdiv.append($('<span>MVP Rate:</span><br>'));
			// mvpdiv.append($('<img src="_assets/stats/F1.png"></img> <span id="mvp1">0</span><br>'));
			// mvpdiv.append($('<img src="_assets/stats/F2.png"></img> <span id="mvp2">0</span><br>'));
			// mvpdiv.append($('<img src="_assets/stats/F3.png"></img> <span id="mvp3">0</span><br>'));
			// mvpdiv.append($('<img src="_assets/stats/F4.png"></img> <span id="mvp4">0</span><br>'));
			// mvpdiv.append($('<img src="_assets/stats/F5.png"></img> <span id="mvp5">0</span><br>'));
			// mvpdiv.append($('<img src="_assets/stats/F6.png"></img> <span id="mvp6">0</span><br>'));

			// var dmgdiv = $('<div style="float:left;width:250px">');
			// multitemp.append(dmgdiv);
			// dmgdiv.append($('<span>Major Damage Rate:</span><br>'));
			// dmgdiv.append($('<img src="_assets/stats/taiha.png"></img>Any: <span id="rredany" style="font-weight:bold">0</span><br>'));
			// dmgdiv.append($('<br>'));
			// dmgdiv.append($('<span>Individual:</span><br>'));
			// dmgdiv.append($('<img src="_assets/stats/F1.png"></img> <span id="red1">0</span><br>'));
			// dmgdiv.append($('<img src="_assets/stats/F2.png"></img> <span id="red2">0</span><br>'));
			// dmgdiv.append($('<img src="_assets/stats/F3.png"></img> <span id="red3">0</span><br>'));
			// dmgdiv.append($('<img src="_assets/stats/F4.png"></img> <span id="red4">0</span><br>'));
			// dmgdiv.append($('<img src="_assets/stats/F5.png"></img> <span id="red5">0</span><br>'));
			// dmgdiv.append($('<img src="_assets/stats/F6.png"></img> <span id="red6">0</span><br>'));
			// dmgdiv.append($('<br>'));
			// dmgdiv.append($('<span>No Medium Damage:</span><br>'));
			// dmgdiv.append($('<img src=""></img> <span id="rnodam">0</span><br>'));
			// dmgdiv.append($('<br>'));

			// var resdiv = $('<div style="float:left;width:250px">');
			// multitemp.append(resdiv);
			// resdiv.append($('<span>Avg Resupply:</span><br>'));
			// resdiv.append($('<img src="_assets/stats/fuel.png"></img> <span id="rfsup">0</span><br>'));
			// resdiv.append($('<img src="_assets/stats/ammo.png"></img> <span id="rasup">0</span><br>'));
			// resdiv.append($('<img src="_assets/stats/baux.png"></img> <span id="rbsup">0</span><br><br>'));
			// resdiv.append($('<span>Avg Repair:</span><br>'));
			// resdiv.append($('<img src="_assets/stats/fuel.png"></img> <span id="rfrep">0</span><br>'));
			// resdiv.append($('<img src="_assets/stats/steel.png"></img> <span id="rsrep">0</span><br><br>'));
			// resdiv.append($('<span>Avg Total Resource:</span><br>'));
			// resdiv.append($('<img src="_assets/stats/fuel.png"></img> <span id="rftot" style="font-weight:bold">0</span><br>'));
			// resdiv.append($('<img src="_assets/stats/ammo.png"></img> <span id="ratot" style="font-weight:bold">0</span><br>'));
			// resdiv.append($('<img src="_assets/stats/steel.png"></img> <span id="rstot" style="font-weight:bold">0</span><br>'));
			// resdiv.append($('<img src="_assets/stats/baux.png"></img> <span id="rbtot" style="font-weight:bold">0</span><br>'));
			// resdiv.append($('<br>'));
		}
	}

	WROTESTATS = true;
}
